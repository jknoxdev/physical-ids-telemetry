<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1901px" preserveAspectRatio="none" style="width:746px;height:1901px;background:#1A1A2E;" version="1.1" viewBox="0 0 746 1901" width="746px" zoomAndPan="magnify"><defs><filter height="300%" id="f1k9hoofudd6ck" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#7EC8E3" font-family="Arial" font-size="18" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="314" x="219.5" y="16.708">L.I.M.A. — Component Diagram</text><text fill="#888888" font-family="Arial" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="163" x="295" y="32.0918">Node + Gateway Internals</text><!--MD5=[b3f1db6b056eee3cb7bc4482000484a1]
cluster node_pkg--><polygon fill="#1A1A2E" filter="url(#f1k9hoofudd6ck)" points="109,58.9219,310,58.9219,317,95.1875,406,95.1875,406,784.9219,109,784.9219,109,58.9219" style="stroke: #FF6B35; stroke-width: 1.5;"/><line style="stroke: #FF6B35; stroke-width: 1.5;" x1="109" x2="317" y1="95.1875" y2="95.1875"/><text fill="#FF6B35" font-family="Arial" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="79" x="171" y="72.9888">LIMA Node</text><text fill="#FF6B35" font-family="Arial" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="195" x="113" y="88.1216">[nRF52840 / Zephyr RTOS]</text><!--MD5=[db2770510d4a287d5bcb38ecffe43dce]
cluster sensors--><polygon fill="#1A1A2E" filter="url(#f1k9hoofudd6ck)" points="145,115.9219,246,115.9219,253,137.0547,379,137.0547,379,213.9219,145,213.9219,145,115.9219" style="stroke: #FF6B35; stroke-width: 1.5;"/><line style="stroke: #FF6B35; stroke-width: 1.5;" x1="145" x2="253" y1="137.0547" y2="137.0547"/><text fill="#FF6B35" font-family="Arial" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="95" x="149" y="129.9888">Sensor Layer</text><!--MD5=[f97f06f0cfb6b7519c6d14147238f0c9]
cluster zephyr--><polygon fill="#1A1A2E" filter="url(#f1k9hoofudd6ck)" points="133,270.9219,285,270.9219,292,292.0547,382,292.0547,382,615.4219,133,615.4219,133,270.9219" style="stroke: #FF6B35; stroke-width: 1.5;"/><line style="stroke: #FF6B35; stroke-width: 1.5;" x1="133" x2="292" y1="292.0547" y2="292.0547"/><text fill="#FF6B35" font-family="Arial" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="146" x="137" y="284.9888">Zephyr Subsystems</text><!--MD5=[11ce9a4a35a443dfb2bbc796942c7cdc]
cluster connectivity--><polygon fill="#1A1A2E" filter="url(#f1k9hoofudd6ck)" points="233,662.9219,329,662.9219,336,684.0547,371,684.0547,371,760.9219,233,760.9219,233,662.9219" style="stroke: #FF6B35; stroke-width: 1.5;"/><line style="stroke: #FF6B35; stroke-width: 1.5;" x1="233" x2="336" y1="684.0547" y2="684.0547"/><text fill="#FF6B35" font-family="Arial" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="90" x="237" y="676.9888">Connectivity</text><!--MD5=[54143f2ae8ba8690653403b130ba7d94]
cluster gateway_pkg--><polygon fill="#1A1A2E" filter="url(#f1k9hoofudd6ck)" points="22,841.9219,174,841.9219,181,878.1875,424,878.1875,424,1889.9219,22,1889.9219,22,841.9219" style="stroke: #FF6B35; stroke-width: 1.5;"/><line style="stroke: #FF6B35; stroke-width: 1.5;" x1="22" x2="181" y1="878.1875" y2="878.1875"/><text fill="#FF6B35" font-family="Arial" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="104" x="47" y="855.9888">LIMA Gateway</text><text fill="#FF6B35" font-family="Arial" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="146" x="26" y="871.1216">[Raspberry Pi Zero]</text><!--MD5=[de27663135fb2e052162af2bb290886b]
cluster ingestion--><polygon fill="#1A1A2E" filter="url(#f1k9hoofudd6ck)" points="237,898.9219,311,898.9219,318,920.0547,400,920.0547,400,1129.9219,237,1129.9219,237,898.9219" style="stroke: #FF6B35; stroke-width: 1.5;"/><line style="stroke: #FF6B35; stroke-width: 1.5;" x1="237" x2="318" y1="920.0547" y2="920.0547"/><text fill="#FF6B35" font-family="Arial" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="68" x="241" y="912.9888">Ingestion</text><!--MD5=[2c917ed10241d073afda6bdfb626813e]
cluster broker_pkg--><polygon fill="#1A1A2E" filter="url(#f1k9hoofudd6ck)" points="249,1186.9219,304,1186.9219,311,1208.0547,379,1208.0547,379,1284.9219,249,1284.9219,249,1186.9219" style="stroke: #FF6B35; stroke-width: 1.5;"/><line style="stroke: #FF6B35; stroke-width: 1.5;" x1="249" x2="311" y1="1208.0547" y2="1208.0547"/><text fill="#FF6B35" font-family="Arial" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="49" x="253" y="1200.9888">Broker</text><!--MD5=[56cc7744dce0ba3f4b240a81bbd86b4d]
cluster processing--><polygon fill="#1A1A2E" filter="url(#f1k9hoofudd6ck)" points="248,1341.9219,381,1341.9219,388,1363.0547,393,1363.0547,393,1560.9219,248,1560.9219,248,1341.9219" style="stroke: #FF6B35; stroke-width: 1.5;"/><line style="stroke: #FF6B35; stroke-width: 1.5;" x1="248" x2="388" y1="1363.0547" y2="1363.0547"/><text fill="#FF6B35" font-family="Arial" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="127" x="252" y="1355.9888">Event Processing</text><!--MD5=[0334151241c2df87d13997940bbf650c]
cluster persistence--><polygon fill="#1A1A2E" filter="url(#f1k9hoofudd6ck)" points="130,1617.9219,222,1617.9219,229,1639.0547,395,1639.0547,395,1722.9219,130,1722.9219,130,1617.9219" style="stroke: #FF6B35; stroke-width: 1.5;"/><line style="stroke: #FF6B35; stroke-width: 1.5;" x1="130" x2="229" y1="1639.0547" y2="1639.0547"/><text fill="#FF6B35" font-family="Arial" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="86" x="134" y="1631.9888">Persistence</text><!--MD5=[5d862a6bf50ccb6523bf200b104f9290]
cluster egress--><polygon fill="#1A1A2E" filter="url(#f1k9hoofudd6ck)" points="46,1767.9219,102,1767.9219,109,1789.0547,374,1789.0547,374,1865.9219,46,1865.9219,46,1767.9219" style="stroke: #FF6B35; stroke-width: 1.5;"/><line style="stroke: #FF6B35; stroke-width: 1.5;" x1="46" x2="109" y1="1789.0547" y2="1789.0547"/><text fill="#FF6B35" font-family="Arial" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="50" x="50" y="1781.9888">Egress</text><!--MD5=[8d83a12329186457828b7f0308b4ff39]
entity imu--><rect fill="#0F3460" filter="url(#f1k9hoofudd6ck)" height="47.9375" style="stroke: #4A90D9; stroke-width: 2.0;" width="79" x="160.5" y="149.9219"/><rect fill="#0F3460" height="5" style="stroke: #4A90D9; stroke-width: 2.0;" width="10" x="155.5" y="154.9219"/><rect fill="#0F3460" height="5" style="stroke: #4A90D9; stroke-width: 2.0;" width="10" x="155.5" y="187.8594"/><text fill="#FFFFFF" font-family="Arial" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="59" x="170.5" y="171.0605">MPU6050</text><text fill="#FFFFFF" font-family="Arial" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="22" x="170.5" y="185.0293">IMU</text><!--MD5=[52a11c404d39c220b9052972b112ecc1]
entity baro--><rect fill="#0F3460" filter="url(#f1k9hoofudd6ck)" height="47.9375" style="stroke: #4A90D9; stroke-width: 2.0;" width="88" x="275" y="149.9219"/><rect fill="#0F3460" height="5" style="stroke: #4A90D9; stroke-width: 2.0;" width="10" x="270" y="154.9219"/><rect fill="#0F3460" height="5" style="stroke: #4A90D9; stroke-width: 2.0;" width="10" x="270" y="187.8594"/><text fill="#FFFFFF" font-family="Arial" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="50" x="285" y="171.0605">BMP280</text><text fill="#FFFFFF" font-family="Arial" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="68" x="285" y="185.0293">Barometric</text><!--MD5=[d3ee787af57c32a6985a7accf4146695]
entity motion--><rect fill="#1A3060" filter="url(#f1k9hoofudd6ck)" height="47.9375" style="stroke: #4A90D9; stroke-width: 2.0;" width="102" x="149" y="304.9219"/><rect fill="#1A3060" height="5" style="stroke: #4A90D9; stroke-width: 2.0;" width="10" x="144" y="309.9219"/><rect fill="#1A3060" height="5" style="stroke: #4A90D9; stroke-width: 2.0;" width="10" x="144" y="342.8594"/><text fill="#FFFFFF" font-family="Arial" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="42" x="159" y="326.0605">Motion</text><text fill="#FFFFFF" font-family="Arial" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="82" x="159" y="340.0293">Discriminator</text><!--MD5=[567192346149ae0109dea2b9891507c0]
entity pressure--><rect fill="#1A3060" filter="url(#f1k9hoofudd6ck)" height="47.9375" style="stroke: #4A90D9; stroke-width: 2.0;" width="76" x="286" y="304.9219"/><rect fill="#1A3060" height="5" style="stroke: #4A90D9; stroke-width: 2.0;" width="10" x="281" y="309.9219"/><rect fill="#1A3060" height="5" style="stroke: #4A90D9; stroke-width: 2.0;" width="10" x="281" y="342.8594"/><text fill="#FFFFFF" font-family="Arial" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="56" x="296" y="326.0605">Pressure</text><text fill="#FFFFFF" font-family="Arial" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="47" x="296" y="340.0293">Monitor</text><!--MD5=[f3bf232d90cabae66f0609ba50eb4d16]
entity aggregator--><rect fill="#1A3060" filter="url(#f1k9hoofudd6ck)" height="47.9375" style="stroke: #4A90D9; stroke-width: 2.0;" width="91" x="245.5" y="425.9219"/><rect fill="#1A3060" height="5" style="stroke: #4A90D9; stroke-width: 2.0;" width="10" x="240.5" y="430.9219"/><rect fill="#1A3060" height="5" style="stroke: #4A90D9; stroke-width: 2.0;" width="10" x="240.5" y="463.8594"/><text fill="#FFFFFF" font-family="Arial" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="35" x="255.5" y="447.0605">Event</text><text fill="#FFFFFF" font-family="Arial" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="71" x="255.5" y="461.0293">Aggregator</text><!--MD5=[6cc4354bc172bfab4bc5d504e938f9dd]
entity crypto--><rect fill="#2A1A4A" filter="url(#f1k9hoofudd6ck)" height="47.9375" style="stroke: #4A90D9; stroke-width: 2.0;" width="110" x="247" y="551.4219"/><rect fill="#2A1A4A" height="5" style="stroke: #4A90D9; stroke-width: 2.0;" width="10" x="242" y="556.4219"/><rect fill="#2A1A4A" height="5" style="stroke: #4A90D9; stroke-width: 2.0;" width="10" x="242" y="589.3594"/><text fill="#FFFFFF" font-family="Arial" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="90" x="257" y="572.5605">CryptoCell-310</text><text fill="#FFFFFF" font-family="Arial" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="40" x="257" y="586.5293">Signer</text><!--MD5=[356b21d33ae4bbe89a0e9541f25b232f]
entity ble--><rect fill="#0F3460" filter="url(#f1k9hoofudd6ck)" height="47.9375" style="stroke: #4A90D9; stroke-width: 2.0;" width="105" x="249.5" y="696.9219"/><rect fill="#0F3460" height="5" style="stroke: #4A90D9; stroke-width: 2.0;" width="10" x="244.5" y="701.9219"/><rect fill="#0F3460" height="5" style="stroke: #4A90D9; stroke-width: 2.0;" width="10" x="244.5" y="734.8594"/><text fill="#FFFFFF" font-family="Arial" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="85" x="259.5" y="718.0605">BLE 5.0 Stack</text><text fill="#FFFFFF" font-family="Arial" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="68" x="259.5" y="732.0293">Coded PHY</text><!--MD5=[fe42e5a4540f19786bf5acf05f7ccff0]
entity scanner--><rect fill="#0F3460" filter="url(#f1k9hoofudd6ck)" height="47.9375" style="stroke: #4A90D9; stroke-width: 2.0;" width="98" x="253" y="932.9219"/><rect fill="#0F3460" height="5" style="stroke: #4A90D9; stroke-width: 2.0;" width="10" x="248" y="937.9219"/><rect fill="#0F3460" height="5" style="stroke: #4A90D9; stroke-width: 2.0;" width="10" x="248" y="970.8594"/><text fill="#FFFFFF" font-family="Arial" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="78" x="263" y="954.0605">BLE Scanner</text><text fill="#FFFFFF" font-family="Arial" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="66" x="263" y="968.0293">blueZ / hci</text><!--MD5=[1fe25e6ad2a661c9f8478b5f50e2a15d]
entity publisher--><rect fill="#0F3460" filter="url(#f1k9hoofudd6ck)" height="47.9375" style="stroke: #4A90D9; stroke-width: 2.0;" width="115" x="254.5" y="1065.9219"/><rect fill="#0F3460" height="5" style="stroke: #4A90D9; stroke-width: 2.0;" width="10" x="249.5" y="1070.9219"/><rect fill="#0F3460" height="5" style="stroke: #4A90D9; stroke-width: 2.0;" width="10" x="249.5" y="1103.8594"/><text fill="#FFFFFF" font-family="Arial" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="95" x="264.5" y="1087.0605">MQTT Publisher</text><text fill="#FFFFFF" font-family="Arial" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="32" x="264.5" y="1101.0293">paho</text><!--MD5=[9707192b7e88357a9c38ee4eac329e3d]
entity mosquitto--><rect fill="#1A3060" filter="url(#f1k9hoofudd6ck)" height="47.9375" style="stroke: #4A90D9; stroke-width: 2.0;" width="98" x="265" y="1220.9219"/><rect fill="#1A3060" height="5" style="stroke: #4A90D9; stroke-width: 2.0;" width="10" x="260" y="1225.9219"/><rect fill="#1A3060" height="5" style="stroke: #4A90D9; stroke-width: 2.0;" width="10" x="260" y="1258.8594"/><text fill="#FFFFFF" font-family="Arial" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="62" x="275" y="1242.0605">Mosquitto</text><text fill="#FFFFFF" font-family="Arial" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="78" x="275" y="1256.0293">MQTT Broker</text><!--MD5=[7342edd9a184d8607391f4c130efbf01]
entity router--><rect fill="#1A3060" filter="url(#f1k9hoofudd6ck)" height="47.9375" style="stroke: #4A90D9; stroke-width: 2.0;" width="101" x="264.5" y="1375.9219"/><rect fill="#1A3060" height="5" style="stroke: #4A90D9; stroke-width: 2.0;" width="10" x="259.5" y="1380.9219"/><rect fill="#1A3060" height="5" style="stroke: #4A90D9; stroke-width: 2.0;" width="10" x="259.5" y="1413.8594"/><text fill="#FFFFFF" font-family="Arial" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="81" x="274.5" y="1397.0605">Event Router</text><text fill="#FFFFFF" font-family="Arial" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="66" x="274.5" y="1411.0293">subscriber</text><!--MD5=[58638f16dd491473315bd2a16a4aea64]
entity verifier--><rect fill="#2A1A4A" filter="url(#f1k9hoofudd6ck)" height="47.9375" style="stroke: #4A90D9; stroke-width: 2.0;" width="81" x="264.5" y="1496.9219"/><rect fill="#2A1A4A" height="5" style="stroke: #4A90D9; stroke-width: 2.0;" width="10" x="259.5" y="1501.9219"/><rect fill="#2A1A4A" height="5" style="stroke: #4A90D9; stroke-width: 2.0;" width="10" x="259.5" y="1534.8594"/><text fill="#FFFFFF" font-family="Arial" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="61" x="274.5" y="1518.0605">Signature</text><text fill="#FFFFFF" font-family="Arial" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="44" x="274.5" y="1532.0293">Verifier</text><!--MD5=[7a603111606425ec6ae263a7f93634a1]
entity sqlite--><path d="M146,1661.9219 C146,1651.9219 182,1651.9219 182,1651.9219 C182,1651.9219 218,1651.9219 218,1661.9219 L218,1696.5313 C218,1706.5313 182,1706.5313 182,1706.5313 C182,1706.5313 146,1706.5313 146,1696.5313 L146,1661.9219 " fill="#2C0E3F" filter="url(#f1k9hoofudd6ck)" style="stroke: #9B59B6; stroke-width: 1.5;"/><path d="M146,1661.9219 C146,1671.9219 182,1671.9219 182,1671.9219 C182,1671.9219 218,1671.9219 218,1661.9219 " fill="none" style="stroke: #9B59B6; stroke-width: 1.5;"/><text fill="#FFFFFF" font-family="Arial" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="37" x="156" y="1686.1323">SQLite</text><text fill="#FFFFFF" font-family="Arial" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="52" x="156" y="1698.937">Audit Log</text><!--MD5=[799e9543975076390d2a6ceafec8df6c]
entity queue--><rect fill="#1A3060" filter="url(#f1k9hoofudd6ck)" height="47.9375" style="stroke: #4A90D9; stroke-width: 2.0;" width="125" x="253.5" y="1655.4219"/><rect fill="#1A3060" height="5" style="stroke: #4A90D9; stroke-width: 2.0;" width="10" x="248.5" y="1660.4219"/><rect fill="#1A3060" height="5" style="stroke: #4A90D9; stroke-width: 2.0;" width="10" x="248.5" y="1693.3594"/><text fill="#FFFFFF" font-family="Arial" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="100" x="263.5" y="1676.5605">Queue Manager</text><text fill="#FFFFFF" font-family="Arial" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="105" x="263.5" y="1690.5293">flush-on-connect</text><!--MD5=[561e10e9526ace52200ca6d4072c2892]
entity push_h--><rect fill="#0F3460" filter="url(#f1k9hoofudd6ck)" height="47.9375" style="stroke: #4A90D9; stroke-width: 2.0;" width="65" x="62.5" y="1801.9219"/><rect fill="#0F3460" height="5" style="stroke: #4A90D9; stroke-width: 2.0;" width="10" x="57.5" y="1806.9219"/><rect fill="#0F3460" height="5" style="stroke: #4A90D9; stroke-width: 2.0;" width="10" x="57.5" y="1839.8594"/><text fill="#FFFFFF" font-family="Arial" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="31" x="72.5" y="1823.0605">Push</text><text fill="#FFFFFF" font-family="Arial" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="45" x="72.5" y="1837.0293">Notifier</text><!--MD5=[3f5443c6f56ec85c4b443f83cd998419]
entity siem_h--><rect fill="#0F3460" filter="url(#f1k9hoofudd6ck)" height="47.9375" style="stroke: #4A90D9; stroke-width: 2.0;" width="83" x="162.5" y="1801.9219"/><rect fill="#0F3460" height="5" style="stroke: #4A90D9; stroke-width: 2.0;" width="10" x="157.5" y="1806.9219"/><rect fill="#0F3460" height="5" style="stroke: #4A90D9; stroke-width: 2.0;" width="10" x="157.5" y="1839.8594"/><text fill="#FFFFFF" font-family="Arial" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="29" x="172.5" y="1823.0605">SIEM</text><text fill="#FFFFFF" font-family="Arial" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="63" x="172.5" y="1837.0293">Forwarder</text><!--MD5=[5ff9b73b4c4545a8b0a91e4c08418fca]
entity cloud_h--><rect fill="#0F3460" filter="url(#f1k9hoofudd6ck)" height="47.9375" style="stroke: #4A90D9; stroke-width: 2.0;" width="77" x="280.5" y="1801.9219"/><rect fill="#0F3460" height="5" style="stroke: #4A90D9; stroke-width: 2.0;" width="10" x="275.5" y="1806.9219"/><rect fill="#0F3460" height="5" style="stroke: #4A90D9; stroke-width: 2.0;" width="10" x="275.5" y="1839.8594"/><text fill="#FFFFFF" font-family="Arial" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="35" x="290.5" y="1823.0605">Cloud</text><text fill="#FFFFFF" font-family="Arial" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="57" x="290.5" y="1837.0293">Uploader</text><path d="M422,546.9219 L422,571.4219 L357.04,575.4219 L422,579.4219 L422,603.4844 A0,0 0 0 0 422,603.4844 L548,603.4844 A0,0 0 0 0 548,603.4844 L548,556.9219 L538,546.9219 L422,546.9219 A0,0 0 0 0 422,546.9219 " fill="#0D2818" filter="url(#f1k9hoofudd6ck)" style="stroke: #27AE60; stroke-width: 1.0;"/><path d="M538,546.9219 L538,556.9219 L548,556.9219 L538,546.9219 " fill="#0D2818" style="stroke: #27AE60; stroke-width: 1.0;"/><text fill="#27AE60" font-family="Arial" font-size="10" lengthAdjust="spacingAndGlyphs" textLength="74" x="428" y="561.2041">CryptoCell-310</text><text fill="#AAAAAA" font-family="Arial" font-size="10" lengthAdjust="spacingAndGlyphs" textLength="105" x="428" y="572.8447">hardware accelerated</text><text fill="#AAAAAA" font-family="Arial" font-size="10" lengthAdjust="spacingAndGlyphs" textLength="102" x="428" y="584.4854">ECDSA-P256 signing</text><text fill="#AAAAAA" font-family="Arial" font-size="10" lengthAdjust="spacingAndGlyphs" textLength="80" x="428" y="596.126">per-event nonce</text><path d="M593.5,1650.9219 L593.5,1707.4844 L734.5,1707.4844 L734.5,1660.9219 L724.5,1650.9219 L593.5,1650.9219 " fill="#0D2818" filter="url(#f1k9hoofudd6ck)" style="stroke: #27AE60; stroke-width: 1.0;"/><path d="M724.5,1650.9219 L724.5,1660.9219 L734.5,1660.9219 L724.5,1650.9219 " fill="#0D2818" style="stroke: #27AE60; stroke-width: 1.0;"/><text fill="#27AE60" font-family="Arial" font-size="10" lengthAdjust="spacingAndGlyphs" textLength="93" x="599.5" y="1665.2041">Always written first</text><text fill="#AAAAAA" font-family="Arial" font-size="10" lengthAdjust="spacingAndGlyphs" textLength="120" x="599.5" y="1676.8447">Queue-and-flush pattern</text><text fill="#AAAAAA" font-family="Arial" font-size="10" lengthAdjust="spacingAndGlyphs" textLength="120" x="599.5" y="1688.4854">Survives internet outage</text><text fill="#AAAAAA" font-family="Arial" font-size="10" lengthAdjust="spacingAndGlyphs" textLength="103" x="599.5" y="1700.126">Local audit trail intact</text><path d="M440,1656.9219 L440,1701.8438 L558,1701.8438 L558,1666.9219 L548,1656.9219 L440,1656.9219 " fill="#0D2818" filter="url(#f1k9hoofudd6ck)" style="stroke: #27AE60; stroke-width: 1.0;"/><path d="M548,1656.9219 L548,1666.9219 L558,1666.9219 L548,1656.9219 " fill="#0D2818" style="stroke: #27AE60; stroke-width: 1.0;"/><text fill="#27AE60" font-family="Arial" font-size="10" lengthAdjust="spacingAndGlyphs" textLength="81" x="446" y="1671.2041">Rejects unsigned</text><text fill="#AAAAAA" font-family="Arial" font-size="10" lengthAdjust="spacingAndGlyphs" textLength="97" x="446" y="1682.8447">or tampered events</text><text fill="#AAAAAA" font-family="Arial" font-size="10" lengthAdjust="spacingAndGlyphs" textLength="88" x="446" y="1694.4854">before any egress</text><!--MD5=[085122f4cbec0865ae5655052ffe2d8c]
link imu to motion--><path d="M200,198.1619 C200,225.2319 200,269.9719 200,299.1919 " fill="none" id="imu-&gt;motion" style="stroke: #7EC8E3; stroke-width: 1.0;"/><polygon fill="#7EC8E3" points="200,304.4619,204,295.4619,200,299.4619,196,295.4619,200,304.4619" style="stroke: #7EC8E3; stroke-width: 1.0;"/><text fill="#AAAAAA" font-family="Arial" font-size="10" lengthAdjust="spacingAndGlyphs" textLength="70" x="201" y="240.2041">raw accel/gyro</text><text fill="#CCCCCC" font-family="Arial" font-size="10" lengthAdjust="spacingAndGlyphs" textLength="25" x="223.5" y="251.8447">[I2C]</text><!--MD5=[d91d4d01b89be0b7ba00b4ee5e7fdbc9]
link baro to pressure--><path d="M319.76,198.1619 C320.64,225.2319 322.11,269.9719 323.06,299.1919 " fill="none" id="baro-&gt;pressure" style="stroke: #7EC8E3; stroke-width: 1.0;"/><polygon fill="#7EC8E3" points="323.23,304.4619,326.9453,295.3407,323.0729,299.4643,318.9493,295.592,323.23,304.4619" style="stroke: #7EC8E3; stroke-width: 1.0;"/><text fill="#AAAAAA" font-family="Arial" font-size="10" lengthAdjust="spacingAndGlyphs" textLength="69" x="322" y="240.2041">pressure delta</text><text fill="#CCCCCC" font-family="Arial" font-size="10" lengthAdjust="spacingAndGlyphs" textLength="25" x="344" y="251.8447">[I2C]</text><!--MD5=[cf549d50d0a94be914127ad89412d84d]
link motion to aggregator--><path d="M208.21,353.2019 C213.53,366.4519 221.28,382.9519 231,395.9219 C238.15,405.4619 247.24,414.5519 256.17,422.4319 " fill="none" id="motion-&gt;aggregator" style="stroke: #7EC8E3; stroke-width: 1.0;"/><polygon fill="#7EC8E3" points="259.98,425.7319,255.7857,416.8208,256.1968,422.4627,250.555,422.8738,259.98,425.7319" style="stroke: #7EC8E3; stroke-width: 1.0;"/><text fill="#AAAAAA" font-family="Arial" font-size="10" lengthAdjust="spacingAndGlyphs" textLength="65" x="232" y="393.2041">motion event</text><!--MD5=[2c4af2db6936246252a206ed84ccfabe]
link pressure to aggregator--><path d="M317.56,353.1519 C312.2,372.4819 304.55,400.0719 298.83,420.6719 " fill="none" id="pressure-&gt;aggregator" style="stroke: #7EC8E3; stroke-width: 1.0;"/><polygon fill="#7EC8E3" points="297.42,425.7519,303.6643,418.1355,298.7464,420.931,295.9509,416.0132,297.42,425.7519" style="stroke: #7EC8E3; stroke-width: 1.0;"/><text fill="#AAAAAA" font-family="Arial" font-size="10" lengthAdjust="spacingAndGlyphs" textLength="73" x="309" y="393.2041">pressure event</text><!--MD5=[789b08637f7949d3ffafc8a5cf428a06]
link aggregator to crypto--><path d="M293.07,474.1519 C294.89,494.5919 297.55,524.4119 299.49,546.2119 " fill="none" id="aggregator-&gt;crypto" style="stroke: #7EC8E3; stroke-width: 1.0;"/><polygon fill="#7EC8E3" points="299.94,551.2919,303.128,541.9733,299.4976,546.3115,295.1594,542.6811,299.94,551.2919" style="stroke: #7EC8E3; stroke-width: 1.0;"/><text fill="#AAAAAA" font-family="Arial" font-size="10" lengthAdjust="spacingAndGlyphs" textLength="71" x="297" y="514.2041">integrity event</text><!--MD5=[20788784c93910f366c1ff4812495cf6]
link crypto to ble--><path d="M302,599.4819 C302,624.4319 302,664.2719 302,691.2319 " fill="none" id="crypto-&gt;ble" style="stroke: #7EC8E3; stroke-width: 1.0;"/><polygon fill="#7EC8E3" points="302,696.4419,306,687.4419,302,691.4419,298,687.4419,302,696.4419" style="stroke: #7EC8E3; stroke-width: 1.0;"/><text fill="#7EC8E3" font-family="Arial" font-size="10" lengthAdjust="spacingAndGlyphs" textLength="72" x="303" y="644.2041">signed payload</text><!--MD5=[2774a6c7155f3b384eeab115e62cb228]
link scanner to publisher--><path d="M303.76,981.0419 C305.45,1003.1619 308.01,1036.6019 309.82,1060.3719 " fill="none" id="scanner-&gt;publisher" style="stroke: #7EC8E3; stroke-width: 1.0;"/><polygon fill="#7EC8E3" points="310.22,1065.5919,313.5139,1056.3102,309.8343,1060.6068,305.5377,1056.9272,310.22,1065.5919" style="stroke: #7EC8E3; stroke-width: 1.0;"/><text fill="#AAAAAA" font-family="Arial" font-size="10" lengthAdjust="spacingAndGlyphs" textLength="94" x="308" y="1021.2041">BLE advertisement</text><text fill="#CCCCCC" font-family="Arial" font-size="10" lengthAdjust="spacingAndGlyphs" textLength="59" x="325.5" y="1032.8447">raw payload</text><!--MD5=[37de4985ded6a92147fb957185689dac]
link publisher to mosquitto--><path d="M312.3,1114.1619 C312.66,1141.2319 313.24,1185.9719 313.62,1215.1919 " fill="none" id="publisher-&gt;mosquitto" style="stroke: #7EC8E3; stroke-width: 1.0;"/><polygon fill="#7EC8E3" points="313.69,1220.4619,317.561,1211.4057,313.6186,1215.4624,309.5618,1211.5199,313.69,1220.4619" style="stroke: #7EC8E3; stroke-width: 1.0;"/><text fill="#AAAAAA" font-family="Arial" font-size="10" lengthAdjust="spacingAndGlyphs" textLength="63" x="314" y="1156.2041">MQTT publish</text><text fill="#CCCCCC" font-family="Arial" font-size="10" lengthAdjust="spacingAndGlyphs" textLength="56" x="317.5" y="1167.8447">lima/events</text><!--MD5=[a338100ca3b7e5f47f33e1e8ebbbe850]
link mosquitto to router--><path d="M314.15,1269.1619 C314.33,1296.2319 314.62,1340.9719 314.81,1370.1919 " fill="none" id="mosquitto-&gt;router" style="stroke: #7EC8E3; stroke-width: 1.0;"/><polygon fill="#7EC8E3" points="314.85,1375.4619,318.7727,1366.4279,314.8071,1370.4621,310.773,1366.4965,314.85,1375.4619" style="stroke: #7EC8E3; stroke-width: 1.0;"/><text fill="#AAAAAA" font-family="Arial" font-size="10" lengthAdjust="spacingAndGlyphs" textLength="45" x="315" y="1311.2041">subscribe</text><text fill="#CCCCCC" font-family="Arial" font-size="10" lengthAdjust="spacingAndGlyphs" textLength="31" x="322" y="1322.8447">lima/#</text><!--MD5=[9614cddcb3196a564517516f23d263db]
link router to verifier--><path d="M313.05,1424.1519 C311.42,1443.4819 309.11,1471.0719 307.37,1491.6719 " fill="none" id="router-&gt;verifier" style="stroke: #7EC8E3; stroke-width: 1.0;"/><polygon fill="#7EC8E3" points="306.95,1496.7519,311.7061,1488.1275,307.3782,1491.7702,303.7355,1487.4424,306.95,1496.7519" style="stroke: #7EC8E3; stroke-width: 1.0;"/><text fill="#AAAAAA" font-family="Arial" font-size="10" lengthAdjust="spacingAndGlyphs" textLength="76" x="311" y="1464.2041">verify signature</text><!--MD5=[66436759b3d8cd1674802c4e73e1eede]
link verifier to sqlite--><path d="M275.18,1545.1619 C264.36,1554.3919 252.47,1565.5219 243,1576.9219 C225.05,1598.5319 208.88,1626.0019 197.7,1646.9019 " fill="none" id="verifier-&gt;sqlite" style="stroke: #7EC8E3; stroke-width: 1.0;"/><polygon fill="#7EC8E3" points="195.26,1651.5319,203.0125,1645.4574,197.604,1647.1154,195.9461,1641.7069,195.26,1651.5319" style="stroke: #7EC8E3; stroke-width: 1.0;"/><text fill="#9B59B6" font-family="Arial" font-size="10" lengthAdjust="spacingAndGlyphs" textLength="55" x="244" y="1587.2041">write event</text><text fill="#CCCCCC" font-family="Arial" font-size="10" lengthAdjust="spacingAndGlyphs" textLength="41" x="251" y="1598.8447">[always]</text><!--MD5=[a445bce60eb940e54124054b471b4943]
link verifier to queue--><path d="M306.62,1545.0119 C308.59,1572.9819 311.9,1620.0819 314.02,1650.1919 " fill="none" id="verifier-&gt;queue" style="stroke: #7EC8E3; stroke-width: 1.0;"/><polygon fill="#7EC8E3" points="314.37,1655.2319,317.7186,1645.9698,314.0138,1650.2446,309.7389,1646.5397,314.37,1655.2319" style="stroke: #7EC8E3; stroke-width: 1.0;"/><text fill="#AAAAAA" font-family="Arial" font-size="10" lengthAdjust="spacingAndGlyphs" textLength="82" x="311" y="1593.2041">queue for egress</text><!--MD5=[b0fa40fcdb02e975154c0607e3090eed]
link queue to push_h--><path d="M286.6,1703.6119 C271.94,1713.8519 253.44,1724.9219 235,1730.9219 C211.48,1738.5819 143.56,1723.7819 124,1738.9219 C106.46,1752.5019 99.44,1777.1519 96.68,1796.5819 " fill="none" id="queue-&gt;push_h" style="stroke: #7EC8E3; stroke-width: 1.0;"/><polygon fill="#7EC8E3" points="96,1801.9219,101.0735,1793.4803,96.6132,1796.9596,93.1339,1792.4993,96,1801.9219" style="stroke: #7EC8E3; stroke-width: 1.0;"/><text fill="#7EC8E3" font-family="Arial" font-size="10" lengthAdjust="spacingAndGlyphs" textLength="83" x="125" y="1749.2041">flush when online</text><!--MD5=[52ae2aa8256b525e165df594e5488d0e]
link queue to siem_h--><path d="M278.88,1703.5819 C253.77,1719.3219 224.98,1737.5319 224,1738.9219 C212.11,1755.7019 207.19,1778.5019 205.2,1796.4119 " fill="none" id="queue-&gt;siem_h" style="stroke: #7EC8E3; stroke-width: 1.0;"/><polygon fill="#7EC8E3" points="204.67,1801.8019,209.5262,1793.2335,205.1562,1796.8256,201.5641,1792.4556,204.67,1801.8019" style="stroke: #7EC8E3; stroke-width: 1.0;"/><text fill="#7EC8E3" font-family="Arial" font-size="10" lengthAdjust="spacingAndGlyphs" textLength="83" x="225" y="1749.2041">flush when online</text><!--MD5=[342f6a06382da582f0f7b60eacf4ef1f]
link queue to cloud_h--><path d="M316.48,1703.6419 C317.01,1728.9219 317.85,1769.3619 318.41,1796.5219 " fill="none" id="queue-&gt;cloud_h" style="stroke: #7EC8E3; stroke-width: 1.0;"/><polygon fill="#7EC8E3" points="318.52,1801.7619,322.3387,1792.6835,318.4197,1796.7629,314.3403,1792.8439,318.52,1801.7619" style="stroke: #7EC8E3; stroke-width: 1.0;"/><text fill="#7EC8E3" font-family="Arial" font-size="10" lengthAdjust="spacingAndGlyphs" textLength="83" x="318" y="1749.2041">flush when online</text><!--MD5=[7724e88a9d9d9258ba0270b3c77ac682]
link ble to scanner--><path d="M302,745.2119 C302,788.4019 302,880.7519 302,927.5219 " fill="none" id="ble-&gt;scanner" style="stroke: #7EC8E3; stroke-width: 1.0;"/><polygon fill="#7EC8E3" points="302,932.7219,306,923.7219,302,927.7219,298,923.7219,302,932.7219" style="stroke: #7EC8E3; stroke-width: 1.0;"/><text fill="#FF6B35" font-family="Arial" font-size="10" lengthAdjust="spacingAndGlyphs" textLength="98" x="306.5" y="811.2041">BLE 5.0 Coded PHY</text><text fill="#CCCCCC" font-family="Arial" font-size="10" lengthAdjust="spacingAndGlyphs" textLength="105" x="303" y="822.8447">[Encrypted + Signed]</text><!--MD5=[2ed7db3ed98489b13e9ef58b5e0ae962]
link sqlite to GMN50--><path d="M195.12,1651.4819 C206.97,1629.9419 226.68,1601.7919 253.5,1589.4219 C315.05,1561.0419 494.9,1565.9819 558.5,1589.4219 C591.48,1601.5819 621.16,1629.1419 640.57,1650.5819 " fill="none" id="sqlite-GMN50" style="stroke: #7EC8E3; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><!--MD5=[0df9c1dfb3b58d5b89b7c765e2da8ceb]
link verifier to GMN53--><path d="M345.83,1541.6519 C363.82,1551.1819 384.74,1563.4719 402,1576.9219 C432.95,1601.0419 463.34,1634.9719 481.63,1656.8319 " fill="none" id="verifier-GMN53" style="stroke: #7EC8E3; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><!--MD5=[8f6608343372ba0cfa58b723034d091c]
@startuml component
!pragma layout smetana

skinparam {
    BackgroundColor #1a1a2e
    ArrowColor #7EC8E3
    ArrowFontColor #CCCCCC
    ArrowFontSize 10
    DefaultFontName Arial
    DefaultFontColor #E0E0E0
    DefaultFontSize 11
    ComponentBorderColor #4A90D9
    ComponentBorderThickness 2
    ComponentBackgroundColor #0f3460
    ComponentFontColor #FFFFFF
    ComponentFontSize 12
    PackageBorderColor #FF6B35
    PackageBorderThickness 2
    PackageBackgroundColor #1a1a2e
    PackageFontColor #FF6B35
    PackageFontSize 13
    DatabaseBorderColor #9B59B6
    DatabaseBackgroundColor #2C0E3F
    DatabaseFontColor #FFFFFF
    InterfaceBorderColor #7EC8E3
    InterfaceBackgroundColor #0f3460
    NoteBorderColor #27AE60
    NoteBackgroundColor #0D2818
    NoteFontColor #AAAAAA
    NoteFontSize 10
}

title <size:18><color:#7EC8E3><b>L.I.M.A. — Component Diagram</b></size>\n<size:12><color:#888888>Node + Gateway Internals</size>

package "LIMA Node\n[nRF52840 / Zephyr RTOS]" as node_pkg {

    package "Sensor Layer" as sensors {
        [MPU6050\nIMU] as imu #0f3460
        [BMP280\nBarometric] as baro #0f3460
    }

    package "Zephyr Subsystems" as zephyr {
        [Motion\nDiscriminator] as motion #1a3060
        [Pressure\nMonitor] as pressure #1a3060
        [Event\nAggregator] as aggregator #1a3060
        [CryptoCell-310\nSigner] as crypto #2a1a4a
    }

    package "Connectivity" as connectivity {
        [BLE 5.0 Stack\nCoded PHY] as ble #0f3460
    }

    imu - -> motion : <color:#AAAAAA>raw accel/gyro\n[I2C]
    baro - -> pressure : <color:#AAAAAA>pressure delta\n[I2C]
    motion - -> aggregator : <color:#AAAAAA>motion event
    pressure - -> aggregator : <color:#AAAAAA>pressure event
    aggregator - -> crypto : <color:#AAAAAA>integrity event
    crypto - -> ble : <color:#7EC8E3>signed payload
}

package "LIMA Gateway\n[Raspberry Pi Zero]" as gateway_pkg {

    package "Ingestion" as ingestion {
        [BLE Scanner\nblueZ / hci] as scanner #0f3460
        [MQTT Publisher\npaho] as publisher #0f3460
    }

    package "Broker" as broker_pkg {
        [Mosquitto\nMQTT Broker] as mosquitto #1a3060
    }

    package "Event Processing" as processing {
        [Event Router\nsubscriber] as router #1a3060
        [Signature\nVerifier] as verifier #2a1a4a
    }

    package "Persistence" as persistence {
        database "SQLite\nAudit Log" as sqlite #2C0E3F
        [Queue Manager\nflush-on-connect] as queue #1a3060
    }

    package "Egress" as egress {
        [Push\nNotifier] as push_h #0f3460
        [SIEM\nForwarder] as siem_h #0f3460
        [Cloud\nUploader] as cloud_h #0f3460
    }

    scanner - -> publisher : <color:#AAAAAA>BLE advertisement\nraw payload
    publisher - -> mosquitto : <color:#AAAAAA>MQTT publish\nlima/events
    mosquitto - -> router : <color:#AAAAAA>subscribe\nlima/#
    router - -> verifier : <color:#AAAAAA>verify signature
    verifier - -> sqlite : <color:#9B59B6>write event\n[always]
    verifier - -> queue : <color:#AAAAAA>queue for egress
    queue - -> push_h : <color:#7EC8E3>flush when online
    queue - -> siem_h : <color:#7EC8E3>flush when online
    queue - -> cloud_h : <color:#7EC8E3>flush when online
}

ble - -> scanner : <color:#FF6B35>BLE 5.0 Coded PHY\n[Encrypted + Signed]

note right of crypto
  <color:#27AE60>CryptoCell-310
  hardware accelerated
  ECDSA-P256 signing
  per-event nonce
end note

note right of sqlite
  <color:#27AE60>Always written first
  Queue-and-flush pattern
  Survives internet outage
  Local audit trail intact
end note

note bottom of verifier
  <color:#27AE60>Rejects unsigned
  or tampered events
  before any egress
end note

@enduml

PlantUML version 1.2020.02(Sun Mar 01 10:22:07 UTC 2020)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 17.0.18+8
Operating System: Linux
Default Encoding: UTF-8
Language: en
Country: null
--></g></svg>